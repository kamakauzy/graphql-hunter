{
  "metadata": {
    "target": "https://countries.trevorblades.com/graphql",
    "profile": "deep",
    "safe_mode": false,
    "timestamp": "2025-11-20T20:56:00.578653"
  },
  "findings": [
    {
      "title": "GraphQL Introspection Enabled",
      "severity": "MEDIUM",
      "description": "The GraphQL endpoint has introspection enabled, which allows attackers to discover the complete API schema including all queries, mutations, types, and fields.",
      "impact": "Attackers can map the entire API surface area, discover hidden or undocumented endpoints, and identify potential attack vectors. This significantly aids reconnaissance and can expose sensitive functionality.",
      "remediation": "Disable introspection in production environments. In most GraphQL implementations, this can be done through configuration settings. Keep introspection enabled only in development/testing environments.",
      "evidence": {
        "introspection_response": "Full schema retrieved successfully"
      },
      "cwe": "CWE-200: Exposure of Sensitive Information to an Unauthorized Actor"
    },
    {
      "title": "Fields With Arguments Identified",
      "severity": "INFO",
      "description": "Found 12 fields that accept arguments. These are potential injection points that should be tested.",
      "impact": "Fields accepting arguments are common injection vectors for SQL injection, NoSQL injection, and other input-based attacks.",
      "remediation": "Ensure all fields with arguments properly validate and sanitize input. Use parameterized queries and input validation.",
      "evidence": {
        "fields_count": 12,
        "sample_fields": [
          {
            "type": "Country",
            "field": "name",
            "args": [
              {
                "name": "lang",
                "description": null,
                "type": {
                  "kind": "SCALAR",
                  "name": "String",
                  "ofType": null
                },
                "defaultValue": null
              }
            ]
          },
          {
            "type": "Query",
            "field": "continent",
            "args": [
              {
                "name": "code",
                "description": null,
                "type": {
                  "kind": "NON_NULL",
                  "name": null,
                  "ofType": {
                    "kind": "SCALAR",
                    "name": "ID",
                    "ofType": null
                  }
                },
                "defaultValue": null
              }
            ]
          },
          {
            "type": "Query",
            "field": "continents",
            "args": [
              {
                "name": "filter",
                "description": null,
                "type": {
                  "kind": "INPUT_OBJECT",
                  "name": "ContinentFilterInput",
                  "ofType": null
                },
                "defaultValue": "{}"
              }
            ]
          },
          {
            "type": "Query",
            "field": "countries",
            "args": [
              {
                "name": "filter",
                "description": null,
                "type": {
                  "kind": "INPUT_OBJECT",
                  "name": "CountryFilterInput",
                  "ofType": null
                },
                "defaultValue": "{}"
              }
            ]
          },
          {
            "type": "Query",
            "field": "country",
            "args": [
              {
                "name": "code",
                "description": null,
                "type": {
                  "kind": "NON_NULL",
                  "name": null,
                  "ofType": {
                    "kind": "SCALAR",
                    "name": "ID",
                    "ofType": null
                  }
                },
                "defaultValue": null
              }
            ]
          }
        ]
      }
    },
    {
      "title": "Unauthenticated Introspection Access",
      "severity": "HIGH",
      "description": "The GraphQL endpoint allows full introspection queries without authentication. This enables anonymous attackers to discover the entire API structure.",
      "impact": "Unauthenticated introspection allows anyone to map the complete API surface, including potentially sensitive queries and mutations. This significantly aids in reconnaissance and attack planning.",
      "remediation": "Require authentication for introspection queries. Implement authentication middleware that validates credentials before processing introspection requests.",
      "evidence": {
        "unauthenticated_introspection": "SUCCESS"
      },
      "cwe": "CWE-306: Missing Authentication for Critical Function"
    },
    {
      "title": "API Accessible Without Authentication",
      "severity": "MEDIUM",
      "description": "The GraphQL endpoint responds to queries without requiring authentication.",
      "impact": "If the API contains sensitive data or operations, lack of authentication allows unauthorized access. This depends on what data is actually exposed.",
      "remediation": "Implement authentication requirements for the GraphQL endpoint. Use middleware to validate authentication tokens before processing queries.",
      "evidence": {
        "unauthenticated_query": "SUCCESS"
      },
      "cwe": "CWE-306: Missing Authentication for Critical Function"
    },
    {
      "title": "Query Depth Limit Enforced",
      "severity": "INFO",
      "description": "The server properly rejects queries exceeding depth 5, indicating depth limiting is implemented.",
      "impact": "None - this is the recommended secure configuration.",
      "remediation": "No action needed. Keep depth limiting enabled.",
      "evidence": {
        "depth_limit": 5
      }
    },
    {
      "title": "No Query Complexity Limit Detected",
      "severity": "MEDIUM",
      "description": "The server accepted a highly complex query without error, suggesting complexity analysis may not be implemented.",
      "impact": "Without complexity limits, attackers can craft expensive queries that consume excessive server resources.",
      "remediation": "Implement query complexity analysis. Tools like graphql-query-complexity can help. Set appropriate complexity thresholds.",
      "evidence": {
        "complex_query_accepted": true
      },
      "cwe": "CWE-400: Uncontrolled Resource Consumption"
    },
    {
      "title": "Batch Size Limit Enforced",
      "severity": "INFO",
      "description": "The server properly limits batch sizes. Batch of 10 was rejected or limited.",
      "impact": "None - this is a security best practice.",
      "remediation": "No action needed. Keep batch limiting enabled.",
      "evidence": {
        "batch_size_limit": 10
      }
    },
    {
      "title": "Field Aliasing Abuse Possible",
      "severity": "HIGH",
      "description": "The server accepted a query with 100 field aliases and took 0.66 seconds to process.",
      "impact": "Field aliasing can be exploited to multiply the cost of a single query by requesting the same expensive field multiple times under different aliases. This can lead to severe resource exhaustion and DoS.",
      "remediation": "Implement query cost analysis that counts aliased fields. Each alias should contribute to the query cost. Consider limiting the total number of fields (including aliases) in a single query.",
      "evidence": {
        "alias_count": 100,
        "response_time": 0.6620030403137207
      },
      "poc": "Query with 100 aliases: { alias0: __typename alias1: __typename alias2: __typename alias3: __typename alias4: __typename alias5: __typename alias6: __typename alias7: __typename alias8: __typename alias9: __typename alias10:...",
      "cwe": "CWE-400: Uncontrolled Resource Consumption"
    }
  ],
  "summary": {
    "total": 8,
    "by_severity": {
      "CRITICAL": 0,
      "HIGH": 2,
      "MEDIUM": 3,
      "LOW": 0,
      "INFO": 3
    }
  }
}