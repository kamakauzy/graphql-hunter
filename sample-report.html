<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GraphQL Hunter Security Report - https://countries.trevorblades.com/graphql</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .header .subtitle {
            font-size: 1.1em;
            opacity: 0.9;
        }
        
        .metadata {
            background: #f8f9fa;
            padding: 30px 40px;
            border-bottom: 3px solid #e9ecef;
        }
        
        .metadata-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }
        
        .metadata-item {
            background: white;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }
        
        .metadata-item label {
            font-weight: 600;
            color: #666;
            font-size: 0.85em;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .metadata-item value {
            display: block;
            color: #333;
            font-size: 1.1em;
            margin-top: 5px;
            word-break: break-all;
        }
        
        .summary {
            padding: 40px;
            background: white;
        }
        
        .summary h2 {
            color: #333;
            margin-bottom: 25px;
            font-size: 1.8em;
        }
        
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            padding: 25px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.2s;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
        }
        
        .stat-card.critical {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
            color: white;
        }
        
        .stat-card.high {
            background: linear-gradient(135deg, #ff8a65 0%, #ff7043 100%);
            color: white;
        }
        
        .stat-card.medium {
            background: linear-gradient(135deg, #ffd54f 0%, #ffb300 100%);
            color: white;
        }
        
        .stat-card.low {
            background: linear-gradient(135deg, #81c784 0%, #66bb6a 100%);
            color: white;
        }
        
        .stat-card.info {
            background: linear-gradient(135deg, #64b5f6 0%, #42a5f5 100%);
            color: white;
        }
        
        .stat-number {
            font-size: 3em;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 0.9em;
            text-transform: uppercase;
            letter-spacing: 1px;
            opacity: 0.9;
        }
        
        .risk-badge {
            display: inline-block;
            padding: 15px 30px;
            border-radius: 50px;
            font-weight: bold;
            font-size: 1.2em;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .risk-critical {
            background: #ff6b6b;
            color: white;
        }
        
        .risk-high {
            background: #ff8a65;
            color: white;
        }
        
        .risk-medium {
            background: #ffd54f;
            color: #333;
        }
        
        .risk-low {
            background: #81c784;
            color: white;
        }
        
        .risk-info {
            background: #64b5f6;
            color: white;
        }
        
        .findings {
            padding: 40px;
            background: #f8f9fa;
        }
        
        .findings h2 {
            color: #333;
            margin-bottom: 25px;
            font-size: 1.8em;
        }
        
        .finding {
            background: white;
            border-radius: 8px;
            padding: 25px;
            margin-bottom: 20px;
            border-left: 5px solid #ccc;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .finding.critical {
            border-left-color: #ff6b6b;
        }
        
        .finding.high {
            border-left-color: #ff8a65;
        }
        
        .finding.medium {
            border-left-color: #ffd54f;
        }
        
        .finding.low {
            border-left-color: #81c784;
        }
        
        .finding.info {
            border-left-color: #64b5f6;
        }
        
        .finding-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .finding-title {
            font-size: 1.4em;
            color: #333;
            font-weight: 600;
        }
        
        .severity-badge {
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: bold;
            font-size: 0.85em;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .severity-critical {
            background: #ff6b6b;
            color: white;
        }
        
        .severity-high {
            background: #ff8a65;
            color: white;
        }
        
        .severity-medium {
            background: #ffd54f;
            color: #333;
        }
        
        .severity-low {
            background: #81c784;
            color: white;
        }
        
        .severity-info {
            background: #64b5f6;
            color: white;
        }
        
        .finding-section {
            margin-top: 15px;
        }
        
        .finding-section h3 {
            color: #667eea;
            font-size: 1em;
            margin-bottom: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .finding-section p {
            color: #555;
            line-height: 1.6;
        }
        
        .evidence {
            background: #f8f9fa;
            border-radius: 5px;
            padding: 15px;
            margin-top: 10px;
            font-family: 'Courier New', monospace;
            font-size: 0.9em;
            overflow-x: auto;
        }
        
        .evidence pre {
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        
        .cwe-badge {
            display: inline-block;
            background: #e9ecef;
            color: #495057;
            padding: 5px 12px;
            border-radius: 15px;
            font-size: 0.85em;
            font-weight: 500;
            margin-top: 10px;
        }
        
        .footer {
            background: #343a40;
            color: white;
            padding: 30px 40px;
            text-align: center;
        }
        
        .footer p {
            margin-bottom: 10px;
        }
        
        .footer a {
            color: #64b5f6;
            text-decoration: none;
        }
        
        .footer a:hover {
            text-decoration: underline;
        }
        
        @media print {
            body {
                background: white;
                padding: 0;
            }
            
            .container {
                box-shadow: none;
            }
            
            .stat-card {
                break-inside: avoid;
            }
            
            .finding {
                break-inside: avoid;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéØ GraphQL Hunter</h1>
            <div class="subtitle">Security Assessment Report</div>
        </div>
        
        <div class="metadata">
            <div class="metadata-grid">
                <div class="metadata-item">
                    <label>Target URL</label>
                    <value>https://countries.trevorblades.com/graphql</value>
                </div>
                <div class="metadata-item">
                    <label>Scan Profile</label>
                    <value>STANDARD</value>
                </div>
                <div class="metadata-item">
                    <label>Scan Date</label>
                    <value>2025-11-20T20:29:01.201663</value>
                </div>
                <div class="metadata-item">
                    <label>Safe Mode</label>
                    <value>Disabled</value>
                </div>
            </div>
        </div>
        
        <div class="summary">
            <h2>üìä Executive Summary</h2>
            <div class="stats-grid">
                <div class="stat-card critical">
                    <div class="stat-number">0</div>
                    <div class="stat-label">Critical</div>
                </div>
                <div class="stat-card high">
                    <div class="stat-number">0</div>
                    <div class="stat-label">High</div>
                </div>
                <div class="stat-card medium">
                    <div class="stat-number">0</div>
                    <div class="stat-label">Medium</div>
                </div>
                <div class="stat-card low">
                    <div class="stat-number">0</div>
                    <div class="stat-label">Low</div>
                </div>
                <div class="stat-card info">
                    <div class="stat-number">0</div>
                    <div class="stat-label">Info</div>
                </div>
            </div>
            <p style="text-align: center; margin-top: 20px;">
                <span class="risk-badge risk-unknown">UNKNOWN Risk</span>
            </p>
            <p style="text-align: center; margin-top: 15px; color: #666;">
                Total Findings: <strong>0</strong>
            </p>
        </div>
        
        <div class="findings">
            <h2>üîç Detailed Findings</h2>
            
            <div class="finding medium">
                <div class="finding-header">
                    <div class="finding-title">GraphQL Introspection Enabled</div>
                    <div class="severity-badge severity-medium">MEDIUM</div>
                </div>
                
                <div class="finding-section">
                    <h3>Description</h3>
                    <p>The GraphQL endpoint has introspection enabled, which allows attackers to discover the complete API schema including all queries, mutations, types, and fields.</p>
                </div>
                
                <div class="finding-section">
                    <h3>Impact</h3>
                    <p>Attackers can map the entire API surface area, discover hidden or undocumented endpoints, and identify potential attack vectors. This significantly aids reconnaissance and can expose sensitive functionality.</p>
                </div>
                
                <div class="finding-section">
                    <h3>Remediation</h3>
                    <p>Disable introspection in production environments. In most GraphQL implementations, this can be done through configuration settings. Keep introspection enabled only in development/testing environments.</p>
                </div>
                
                <div class="evidence"><pre>introspection_response: Full schema retrieved successfully</pre></div>
                <div class="cwe-badge">CWE-200: Exposure of Sensitive Information to an Unauthorized Actor</div>
            </div>
            

            <div class="finding info">
                <div class="finding-header">
                    <div class="finding-title">Fields With Arguments Identified</div>
                    <div class="severity-badge severity-info">INFO</div>
                </div>
                
                <div class="finding-section">
                    <h3>Description</h3>
                    <p>Found 12 fields that accept arguments. These are potential injection points that should be tested.</p>
                </div>
                
                <div class="finding-section">
                    <h3>Impact</h3>
                    <p>Fields accepting arguments are common injection vectors for SQL injection, NoSQL injection, and other input-based attacks.</p>
                </div>
                
                <div class="finding-section">
                    <h3>Remediation</h3>
                    <p>Ensure all fields with arguments properly validate and sanitize input. Use parameterized queries and input validation.</p>
                </div>
                
                <div class="evidence"><pre>fields_count: 12
sample_fields: [{&#x27;type&#x27;: &#x27;Country&#x27;, &#x27;field&#x27;: &#x27;name&#x27;, &#x27;args&#x27;: [{&#x27;name&#x27;: &#x27;lang&#x27;, &#x27;description&#x27;: None, &#x27;type&#x27;: {&#x27;kind&#x27;: &#x27;SCALAR&#x27;, &#x27;name&#x27;: &#x27;String&#x27;, &#x27;ofType&#x27;: None}, &#x27;defaultValue&#x27;: None}]}, {&#x27;type&#x27;: &#x27;Query&#x27;, &#x27;field&#x27;: &#x27;continent&#x27;, &#x27;args&#x27;: [{&#x27;name&#x27;: &#x27;code&#x27;, &#x27;description&#x27;: None, &#x27;type&#x27;: {&#x27;kind&#x27;: &#x27;NON_NULL&#x27;, &#x27;name&#x27;: None, &#x27;ofType&#x27;: {&#x27;kind&#x27;: &#x27;SCALAR&#x27;, &#x27;name&#x27;: &#x27;ID&#x27;, &#x27;ofType&#x27;: None}}, &#x27;defaultValue&#x27;: None}]}, {&#x27;type&#x27;: &#x27;Query&#x27;, &#x27;field&#x27;: &#x27;continents&#x27;, &#x27;args&#x27;: [{&#x27;name&#x27;: &#x27;filter&#x27;, &#x27;description&#x27;: None, &#x27;type&#x27;: {&#x27;kind&#x27;: &#x27;INPUT_OBJECT&#x27;, &#x27;name&#x27;: &#x27;ContinentFilterInput&#x27;, &#x27;ofType&#x27;: None}, &#x27;defaultValue&#x27;: &#x27;{}&#x27;}]}, {&#x27;type&#x27;: &#x27;Query&#x27;, &#x27;field&#x27;: &#x27;countries&#x27;, &#x27;args&#x27;: [{&#x27;name&#x27;: &#x27;filter&#x27;, &#x27;description&#x27;: None, &#x27;type&#x27;: {&#x27;kind&#x27;: &#x27;INPUT_OBJECT&#x27;, &#x27;name&#x27;: &#x27;CountryFilterInput&#x27;, &#x27;ofType&#x27;: None}, &#x27;defaultValue&#x27;: &#x27;{}&#x27;}]}, {&#x27;type&#x27;: &#x27;Query&#x27;, &#x27;field&#x27;: &#x27;country&#x27;, &#x27;args&#x27;: [{&#x27;name&#x27;: &#x27;code&#x27;, &#x27;description&#x27;: None, &#x27;type&#x27;: {&#x27;kind&#x27;: &#x27;NON_NULL&#x27;, &#x27;name&#x27;: None, &#x27;ofType&#x27;: {&#x27;kind&#x27;: &#x27;SCALAR&#x27;, &#x27;name&#x27;: &#x27;ID&#x27;, &#x27;ofType&#x27;: None}}, &#x27;defaultValue&#x27;: None}]}]</pre></div>
                
            </div>
            

            <div class="finding high">
                <div class="finding-header">
                    <div class="finding-title">Unauthenticated Introspection Access</div>
                    <div class="severity-badge severity-high">HIGH</div>
                </div>
                
                <div class="finding-section">
                    <h3>Description</h3>
                    <p>The GraphQL endpoint allows full introspection queries without authentication. This enables anonymous attackers to discover the entire API structure.</p>
                </div>
                
                <div class="finding-section">
                    <h3>Impact</h3>
                    <p>Unauthenticated introspection allows anyone to map the complete API surface, including potentially sensitive queries and mutations. This significantly aids in reconnaissance and attack planning.</p>
                </div>
                
                <div class="finding-section">
                    <h3>Remediation</h3>
                    <p>Require authentication for introspection queries. Implement authentication middleware that validates credentials before processing introspection requests.</p>
                </div>
                
                <div class="evidence"><pre>unauthenticated_introspection: SUCCESS</pre></div>
                <div class="cwe-badge">CWE-306: Missing Authentication for Critical Function</div>
            </div>
            

            <div class="finding medium">
                <div class="finding-header">
                    <div class="finding-title">API Accessible Without Authentication</div>
                    <div class="severity-badge severity-medium">MEDIUM</div>
                </div>
                
                <div class="finding-section">
                    <h3>Description</h3>
                    <p>The GraphQL endpoint responds to queries without requiring authentication.</p>
                </div>
                
                <div class="finding-section">
                    <h3>Impact</h3>
                    <p>If the API contains sensitive data or operations, lack of authentication allows unauthorized access. This depends on what data is actually exposed.</p>
                </div>
                
                <div class="finding-section">
                    <h3>Remediation</h3>
                    <p>Implement authentication requirements for the GraphQL endpoint. Use middleware to validate authentication tokens before processing queries.</p>
                </div>
                
                <div class="evidence"><pre>unauthenticated_query: SUCCESS</pre></div>
                <div class="cwe-badge">CWE-306: Missing Authentication for Critical Function</div>
            </div>
            

            <div class="finding info">
                <div class="finding-header">
                    <div class="finding-title">Query Depth Limit Enforced</div>
                    <div class="severity-badge severity-info">INFO</div>
                </div>
                
                <div class="finding-section">
                    <h3>Description</h3>
                    <p>The server properly rejects queries exceeding depth 5, indicating depth limiting is implemented.</p>
                </div>
                
                <div class="finding-section">
                    <h3>Impact</h3>
                    <p>None - this is the recommended secure configuration.</p>
                </div>
                
                <div class="finding-section">
                    <h3>Remediation</h3>
                    <p>No action needed. Keep depth limiting enabled.</p>
                </div>
                
                <div class="evidence"><pre>depth_limit: 5</pre></div>
                
            </div>
            

            <div class="finding medium">
                <div class="finding-header">
                    <div class="finding-title">No Query Complexity Limit Detected</div>
                    <div class="severity-badge severity-medium">MEDIUM</div>
                </div>
                
                <div class="finding-section">
                    <h3>Description</h3>
                    <p>The server accepted a highly complex query without error, suggesting complexity analysis may not be implemented.</p>
                </div>
                
                <div class="finding-section">
                    <h3>Impact</h3>
                    <p>Without complexity limits, attackers can craft expensive queries that consume excessive server resources.</p>
                </div>
                
                <div class="finding-section">
                    <h3>Remediation</h3>
                    <p>Implement query complexity analysis. Tools like graphql-query-complexity can help. Set appropriate complexity thresholds.</p>
                </div>
                
                <div class="evidence"><pre>complex_query_accepted: True</pre></div>
                <div class="cwe-badge">CWE-400: Uncontrolled Resource Consumption</div>
            </div>
            

            <div class="finding info">
                <div class="finding-header">
                    <div class="finding-title">Batch Size Limit Enforced</div>
                    <div class="severity-badge severity-info">INFO</div>
                </div>
                
                <div class="finding-section">
                    <h3>Description</h3>
                    <p>The server properly limits batch sizes. Batch of 10 was rejected or limited.</p>
                </div>
                
                <div class="finding-section">
                    <h3>Impact</h3>
                    <p>None - this is a security best practice.</p>
                </div>
                
                <div class="finding-section">
                    <h3>Remediation</h3>
                    <p>No action needed. Keep batch limiting enabled.</p>
                </div>
                
                <div class="evidence"><pre>batch_size_limit: 10</pre></div>
                
            </div>
            
        </div>
        
        <div class="footer">
            <p><strong>GraphQL Hunter v1.0</strong></p>
            <p>Generated on 2025-11-20 14:29:12</p>
            <p>For questions or support, contact <a href="mailto:brad@securit360.com">brad@securit360.com</a></p>
            <p style="margin-top: 15px; font-size: 0.9em; opacity: 0.8;">
                This report is for authorized security testing only. Always obtain proper authorization before testing.
            </p>
        </div>
    </div>
</body>
</html>